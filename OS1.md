# OS１章
オペレーティングシステムはユーザーとハードウェアを仲介するものであり、基本ソフトウェアと呼ばれる。

## なぜOSが必要か
- ユーザー：
  ぼくたち

- ハードウェア：
  中央処理装置(CPU・プロセッサ)：クロックして命令の解読や実行を行う。最近は4GHzぐらい。
  主記憶装置(メモリ・メインメモリ)：CPUが用いる、一時的に情報を保存(揮発性)する場所
  補助記憶装置(ストレージ)：長期的に情報(不揮発性)を保存する場所

コンピューターはプログラムを実行して(プロセス)なんやかんややるけど、それを行うには何が必要か？
複数のプログラムを同時に実行(並列処理)するにはメモリ管理、プロセス管理が必要。
プログラムは基本的に補助記憶装置に保存されている(macならSSDかな)。それをメインメモリに持ってきて実行するから、
ファイルにお邪魔する許可をあげたり(ファイル管理)する。

抽象化：ファイルとかも抽象化の賜物らしいね。

## OSの構造
OSの主な機能を提供する中核のプログラムをkernelという。kernelは狭義のOSとも言えるが、広義のOSはもう少し広い。
kernelのサービスを受けるにあたってはスーパーバイザコールを必要とする。

## カーネルの機能
### プロセス管理
- プロセス(実行中のプログラム)を生成したり、消滅させたり、プロセスの全てを管理する。

### スケジューラ
- プロセス間でプロセッサを高速に切り替えることで複数のプロセスを同時に処理しているように見せかけることができる(マルチタスク)。マルチタスクにより、スループットを上げることができる。
- スケジューラは、タイマからの割り込みにより起動し、各プロセスの状態を把握して、プロセッサの割り当てなどを決定する。

### 同期と通信
- 並列にプロセスが処理される場合、データやプログラムなどの資源を共有することがある。お互いに干渉しないように、それらの間で連絡を取り合わねばならない。同期と通信はこれに役立つ。

### メモリ管理
- プログラムやデータは、実行や参照に先立って、SSDなどの補助記憶装置からメインメモリに移動させておく必要がある。OSは、どのプログラム、データをどこのメモリに配置するかを決定する。

### 割り込みと出入力処理
- 割り込みは、出入力装置の状態をCPUに伝えるための仕組みである。割り込みを検知すると、現在実行中のプロセスの状態を保存しておいて、割り込みハンドラーを起動させる。割り込みハンドラーは割り込みに対して処理を行い、再び先ほどまでのプロセスに実行を移す。

### ファイルシステム
- ファイルはファイルの集合であり、データ、プログラムを格納する単位。補助記憶装置に存在する。

### ブートストラップ
- 電源を入れてからOSが起動するまでの一連の動作をブートストラップという。通常、プログラムやデータはカーネル(OS)によって主記憶装置に載せられる。しかし、カーネルそのものもプログラムであるので、なんらかの形で主記憶装置に乗せる必要がある。そこで、ROMなどに小さなプログラムを用意しておき、起動時に補助記憶装置上にあるブートローダが起動してカーネルを主記憶装置に移す。

## カーネルの構成
- 昔はアセンブリ言語で書かれていたが、現在はC言語などの高水準言語で書かれている。

### モノリシックカーネル
- カーネルの機能のほとんどを１つのプログラムに組み込んだもの。１つのプログラムに入っているので実行時間が高速だが、機能の一部を削除。LinuxなどのUnix系はこれ。
### マイクロカーネル
- 割り込み処理などの最低限のOSの機能だけをカーネルに実現して、それ以外をカーネル街のプロセスにより実現する。昨日の編集が簡単。
- プロセス同士の通信がオーバーヘッドとなり、動作がやや遅い。

- WindowsとかmacOSはモノリシックとマイクロの合わせ技らしい。

## カーネルの移植性
- 昔は、OSはある特定のハードウェアのためだけに動けばよかった。
- 今は、いろんなハードウェアに対して同じOSが動作して欲しい。ハードウェア依存の部分と、ハードウェアによらない部分を切り分ける作業が行われている(ハードウェアの抽象化)。

## シェル
- 一般的には、ユーザーはカーネルに対して直接命令を与えることはできない。そこで、ユーザーインターフェース(UI)を通して命令を送る。CUIとGUIがある。文字いっぱいか絵とかいっぱいかの違い。

## OSの歴史
だるいからChatGPTくんにようやくさせた。えらいね。( *´･ᴗ･)/(gpt`)ﾖｼﾖｼ
- 初期のコンピュータシステムにはOSがなく、ユーザが機械語でプログラムを作成し、直接メモリにロードしていました（第0世代）。1950年代に入り、複数のジョブを一括で処理するバッチ処理OSが登場し、パンチカードを使ってデータを入力していました（第1世代）。1960年代になると、OSはマルチプログラミングやタイムシェアリング機能を提供し、複数ユーザが同時に利用できるようになりました。また、この時代に仮想記憶の概念も発明されましたが、実用化は第3世代以降となりました（第2世代）
- 第3世代のコンピュータシステムは、汎用の大型計算機（メインフレーム）として開発され、バッチ処理、マルチプログラミング、タイムシェアリングなどの機能を同時に提供しました。第4世代では、LSI技術によりCPUの性能が向上しましたが、OSのアーキテクチャは第3世代のものを引き継いでいます。

## 組み込みOS
- CPUが安価になるにつれ、電化製品にもCPUが搭載されることになった。そのためのOSを組み込みOSという。組み込みOSは軽量であることが求められたが、現在はIoTなどの影響で高性能のOSが求められているので、Linuxなどの汎用OSを用いることが増えている。

### リアルタイムOS
- 短い時間で動作を終える必要があるOSのことを、リアルタイムOSという。自動車のブレーキとか(それはハードウェアの問題かな？とりあえずそんな感じ)。ガチで時間を守らないとダメなものをハードリアルタイム、そんなに厳密じゃないものをソフトリアルタイムという。
- 最近はLinuxなどの汎用OSにリアルタイムを追加したものもある。RTLinuxとか。

###　スマホのOS
- iPhone: iOS Mac OS Xがベース
- Googleは　Android : Linuxがベース　どっちもUnix系らしい。

## 演習問題答案
### 1
以下にOSの機能をあげ、それぞれ概説する。
- プロセス管理：アプリケーションやユーザーは複数のプログラムの処理をCPUに依頼するためプロセス(実行中のプログラム)の管理が必要であり、OSはそれを担う。OSはすべてのプロセスを把握、管理する。
- スケジューラ：スケジューラはタイマの割り込みに反応して起動し、プロセスの状態(実行待ち、実行中など)を把握する。OSはプロセスの状態に応じて、プロセスの実行開始などをスケジューリングする。
- 同期と通信：複数のプロセスが同一の資源を共有する状況は珍しくなく、その際はお互いのプロセスが干渉し合わないように双方が連携を図る必要がある。同期・通信はそれに一役かう。
### 2
- 



